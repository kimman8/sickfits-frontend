import _objectSpread from '@babel/runtime/helpers/esm/objectSpread2';
import Path__default from 'path';
import withPreconstruct from '@preconstruct/next';

const config = withPreconstruct({
  typescript: {
    ignoreBuildErrors: true
  },
  eslint: {
    ignoreDuringBuilds: true
  },

  webpack(config, {
    isServer
  }) {
    config.resolve.alias = _objectSpread(_objectSpread({}, config.resolve.alias), {}, {
      react: Path__default.dirname(require.resolve('react/package.json')),
      'react-dom': Path__default.dirname(require.resolve('react-dom/package.json')),
      '@keystone-next/keystone': Path__default.dirname(require.resolve('@keystone-next/keystone/package.json'))
    });

    if (isServer) {
      config.externals = [...config.externals, /@keystone-next\/keystone(?!\/___internal-do-not-use-will-break-in-patch\/admin-ui\/id-field-view|\/fields\/types\/[^\/]+\/views)/, '.prisma/client'];
    }

    return config;
  }

});

export { config };
